{% extends 'image_base.html' %}

 {% block cssExtras %}
 {{ block.super }}
    <link rel="stylesheet" type="text/css" href="{{ EXTERNAL_URL }}dropzone/dist/min/dropzone.min.css"></link>
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}xgds_image/css/xgds_image.css"></link>
 {% endblock cssExtras %}


{% block jsInit %}
	initializePackery();
{% endblock %}


{% block scripts %}
{{block.super}}
	<script type="text/javascript" src='{{ EXTERNAL_URL }}/handlebars/handlebars.min.js'></script>
	<script type="text/javascript" src='{{ EXTERNAL_URL }}dropzone/dist/dropzone.js'></script>
	<script type="text/javascript" src="{{ EXTERNAL_URL }}datatables/media/js/jquery.dataTables.min.js"></script>
	<script type="text/javascript" src="{{ STATIC_URL }}geocamUtil/js/datatable_helpers.js"></script>
	<script type="text/javascript" src="{{ EXTERNAL_URL }}packery/dist/packery.pkgd.min.js" ></script>
	<script type="text/javascript" src="{{ STATIC_URL }}xgds_image/js/packem.js"></script>
    
    <!--  parse image json -->
    <script type="text/javascript">
    var uploadedImages = {{ uploadedImages|safe }};
    var images = []; // stores JSON objects
    $(uploadedImages).each(function() {
    	images.push(JSON.parse(this)); // parse json string
    });
    </script>
    <script type="text/javascript" src="{{ STATIC_URL }}xgds_image/js/imageUpload.js"></script>
	
	<!--  load handlebars -->
	<script type="text/javascript" src="/static/geocamUtil/js/datatable_helpers.js"></script>
	{% for template_name, template in templates.items %}
		<script type="text/handlebars" id="template-{{template_name}}">
			{{template|safe}}
		</script>
	{% endfor %}
{% endblock %}


{% block content %}
	{% block packery %}
	<div id="container"> 
		<div class='item w2 lockAspect' id='item_image_upload'>
			<!-- Dropzone image upload -->
			<form class="dropzone" id="image-drop-zone" action="{% url 'xgds_save_image' %}" method="post" 
			enctype="multipart/form-data">
			{% csrf_token %}
			</form>
			<button id="submit-all">
				Upload Images
			</button>
		</div>
		
		<!-- Image list table -->
		<div class='item w2 lockAspect' id='item_image_table'>
			<div id="image_table_div"> 
				<table cellpadding="0" cellspacing="0" border="0"  id="image_table">
					<thead class="table_header">
						<tr>
							<th>Name</th>
						    <th>Timestamp</th>
						    <th>Source</th>
						    <th>Latitude</th>
						    <th>Longitude</th>
						    <th>Altitude</th>
					    </tr>
					</thead>
					<tbody>
					</tbody>
				</table>
			</div>
		</div>
	</div> <!--  js packery container -->
	{% endblock packery %}
{% endblock content %}